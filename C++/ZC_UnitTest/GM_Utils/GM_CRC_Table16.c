/**
* @file GM_CRC_Table16.c
* @brief 常用CRC查表用的表
* @author
* @date 
* @version
* <pre><b>copyright: 

*/

#include "GM_CRC_Table16.h"


/** @brief 多项式0x11021的正序CRC表 */
const GM_UINT16 GM_CRC16_Table_0x11021_MSB[256U] =
{
    0x0000U, 0x1021U, 0x2042U, 0x3063U, 0x4084U, 0x50A5U, 0x60C6U, 0x70E7U,
    0x8108U, 0x9129U, 0xA14AU, 0xB16BU, 0xC18CU, 0xD1ADU, 0xE1CEU, 0xF1EFU,
    0x1231U, 0x0210U, 0x3273U, 0x2252U, 0x52B5U, 0x4294U, 0x72F7U, 0x62D6U,
    0x9339U, 0x8318U, 0xB37BU, 0xA35AU, 0xD3BDU, 0xC39CU, 0xF3FFU, 0xE3DEU,
    0x2462U, 0x3443U, 0x0420U, 0x1401U, 0x64E6U, 0x74C7U, 0x44A4U, 0x5485U,
    0xA56AU, 0xB54BU, 0x8528U, 0x9509U, 0xE5EEU, 0xF5CFU, 0xC5ACU, 0xD58DU,
    0x3653U, 0x2672U, 0x1611U, 0x0630U, 0x76D7U, 0x66F6U, 0x5695U, 0x46B4U,
    0xB75BU, 0xA77AU, 0x9719U, 0x8738U, 0xF7DFU, 0xE7FEU, 0xD79DU, 0xC7BCU,
    0x48C4U, 0x58E5U, 0x6886U, 0x78A7U, 0x0840U, 0x1861U, 0x2802U, 0x3823U,
    0xC9CCU, 0xD9EDU, 0xE98EU, 0xF9AFU, 0x8948U, 0x9969U, 0xA90AU, 0xB92BU,
    0x5AF5U, 0x4AD4U, 0x7AB7U, 0x6A96U, 0x1A71U, 0x0A50U, 0x3A33U, 0x2A12U,
    0xDBFDU, 0xCBDCU, 0xFBBFU, 0xEB9EU, 0x9B79U, 0x8B58U, 0xBB3BU, 0xAB1AU,
    0x6CA6U, 0x7C87U, 0x4CE4U, 0x5CC5U, 0x2C22U, 0x3C03U, 0x0C60U, 0x1C41U,
    0xEDAEU, 0xFD8FU, 0xCDECU, 0xDDCDU, 0xAD2AU, 0xBD0BU, 0x8D68U, 0x9D49U,
    0x7E97U, 0x6EB6U, 0x5ED5U, 0x4EF4U, 0x3E13U, 0x2E32U, 0x1E51U, 0x0E70U,
    0xFF9FU, 0xEFBEU, 0xDFDDU, 0xCFFCU, 0xBF1BU, 0xAF3AU, 0x9F59U, 0x8F78U,
    0x9188U, 0x81A9U, 0xB1CAU, 0xA1EBU, 0xD10CU, 0xC12DU, 0xF14EU, 0xE16FU,
    0x1080U, 0x00A1U, 0x30C2U, 0x20E3U, 0x5004U, 0x4025U, 0x7046U, 0x6067U,
    0x83B9U, 0x9398U, 0xA3FBU, 0xB3DAU, 0xC33DU, 0xD31CU, 0xE37FU, 0xF35EU,
    0x02B1U, 0x1290U, 0x22F3U, 0x32D2U, 0x4235U, 0x5214U, 0x6277U, 0x7256U,
    0xB5EAU, 0xA5CBU, 0x95A8U, 0x8589U, 0xF56EU, 0xE54FU, 0xD52CU, 0xC50DU,
    0x34E2U, 0x24C3U, 0x14A0U, 0x0481U, 0x7466U, 0x6447U, 0x5424U, 0x4405U,
    0xA7DBU, 0xB7FAU, 0x8799U, 0x97B8U, 0xE75FU, 0xF77EU, 0xC71DU, 0xD73CU,
    0x26D3U, 0x36F2U, 0x0691U, 0x16B0U, 0x6657U, 0x7676U, 0x4615U, 0x5634U,
    0xD94CU, 0xC96DU, 0xF90EU, 0xE92FU, 0x99C8U, 0x89E9U, 0xB98AU, 0xA9ABU,
    0x5844U, 0x4865U, 0x7806U, 0x6827U, 0x18C0U, 0x08E1U, 0x3882U, 0x28A3U,
    0xCB7DU, 0xDB5CU, 0xEB3FU, 0xFB1EU, 0x8BF9U, 0x9BD8U, 0xABBBU, 0xBB9AU,
    0x4A75U, 0x5A54U, 0x6A37U, 0x7A16U, 0x0AF1U, 0x1AD0U, 0x2AB3U, 0x3A92U,
    0xFD2EU, 0xED0FU, 0xDD6CU, 0xCD4DU, 0xBDAAU, 0xAD8BU, 0x9DE8U, 0x8DC9U,
    0x7C26U, 0x6C07U, 0x5C64U, 0x4C45U, 0x3CA2U, 0x2C83U, 0x1CE0U, 0x0CC1U,
    0xEF1FU, 0xFF3EU, 0xCF5DU, 0xDF7CU, 0xAF9BU, 0xBFBAU, 0x8FD9U, 0x9FF8U,
    0x6E17U, 0x7E36U, 0x4E55U, 0x5E74U, 0x2E93U, 0x3EB2U, 0x0ED1U, 0x1EF0U
};

/** @brief 多项式0x11021的逆序CRC表(0x18408) */
const GM_UINT16 GM_CRC16_Table_0x11021_LSB[256U] =
{
    0x0000U, 0x1189U, 0x2312U, 0x329BU, 0x4624U, 0x57ADU, 0x6536U, 0x74BFU,
    0x8C48U, 0x9DC1U, 0xAF5AU, 0xBED3U, 0xCA6CU, 0xDBE5U, 0xE97EU, 0xF8F7U,
    0x1081U, 0x0108U, 0x3393U, 0x221AU, 0x56A5U, 0x472CU, 0x75B7U, 0x643EU,
    0x9CC9U, 0x8D40U, 0xBFDBU, 0xAE52U, 0xDAEDU, 0xCB64U, 0xF9FFU, 0xE876U,
    0x2102U, 0x308BU, 0x0210U, 0x1399U, 0x6726U, 0x76AFU, 0x4434U, 0x55BDU,
    0xAD4AU, 0xBCC3U, 0x8E58U, 0x9FD1U, 0xEB6EU, 0xFAE7U, 0xC87CU, 0xD9F5U,
    0x3183U, 0x200AU, 0x1291U, 0x0318U, 0x77A7U, 0x662EU, 0x54B5U, 0x453CU,
    0xBDCBU, 0xAC42U, 0x9ED9U, 0x8F50U, 0xFBEFU, 0xEA66U, 0xD8FDU, 0xC974U,
    0x4204U, 0x538DU, 0x6116U, 0x709FU, 0x0420U, 0x15A9U, 0x2732U, 0x36BBU,
    0xCE4CU, 0xDFC5U, 0xED5EU, 0xFCD7U, 0x8868U, 0x99E1U, 0xAB7AU, 0xBAF3U,
    0x5285U, 0x430CU, 0x7197U, 0x601EU, 0x14A1U, 0x0528U, 0x37B3U, 0x263AU,
    0xDECDU, 0xCF44U, 0xFDDFU, 0xEC56U, 0x98E9U, 0x8960U, 0xBBFBU, 0xAA72U,
    0x6306U, 0x728FU, 0x4014U, 0x519DU, 0x2522U, 0x34ABU, 0x0630U, 0x17B9U,
    0xEF4EU, 0xFEC7U, 0xCC5CU, 0xDDD5U, 0xA96AU, 0xB8E3U, 0x8A78U, 0x9BF1U,
    0x7387U, 0x620EU, 0x5095U, 0x411CU, 0x35A3U, 0x242AU, 0x16B1U, 0x0738U,
    0xFFCFU, 0xEE46U, 0xDCDDU, 0xCD54U, 0xB9EBU, 0xA862U, 0x9AF9U, 0x8B70U,
    0x8408U, 0x9581U, 0xA71AU, 0xB693U, 0xC22CU, 0xD3A5U, 0xE13EU, 0xF0B7U,
    0x0840U, 0x19C9U, 0x2B52U, 0x3ADBU, 0x4E64U, 0x5FEDU, 0x6D76U, 0x7CFFU,
    0x9489U, 0x8500U, 0xB79BU, 0xA612U, 0xD2ADU, 0xC324U, 0xF1BFU, 0xE036U,
    0x18C1U, 0x0948U, 0x3BD3U, 0x2A5AU, 0x5EE5U, 0x4F6CU, 0x7DF7U, 0x6C7EU,
    0xA50AU, 0xB483U, 0x8618U, 0x9791U, 0xE32EU, 0xF2A7U, 0xC03CU, 0xD1B5U,
    0x2942U, 0x38CBU, 0x0A50U, 0x1BD9U, 0x6F66U, 0x7EEFU, 0x4C74U, 0x5DFDU,
    0xB58BU, 0xA402U, 0x9699U, 0x8710U, 0xF3AFU, 0xE226U, 0xD0BDU, 0xC134U,
    0x39C3U, 0x284AU, 0x1AD1U, 0x0B58U, 0x7FE7U, 0x6E6EU, 0x5CF5U, 0x4D7CU,
    0xC60CU, 0xD785U, 0xE51EU, 0xF497U, 0x8028U, 0x91A1U, 0xA33AU, 0xB2B3U,
    0x4A44U, 0x5BCDU, 0x6956U, 0x78DFU, 0x0C60U, 0x1DE9U, 0x2F72U, 0x3EFBU,
    0xD68DU, 0xC704U, 0xF59FU, 0xE416U, 0x90A9U, 0x8120U, 0xB3BBU, 0xA232U,
    0x5AC5U, 0x4B4CU, 0x79D7U, 0x685EU, 0x1CE1U, 0x0D68U, 0x3FF3U, 0x2E7AU,
    0xE70EU, 0xF687U, 0xC41CU, 0xD595U, 0xA12AU, 0xB0A3U, 0x8238U, 0x93B1U,
    0x6B46U, 0x7ACFU, 0x4854U, 0x59DDU, 0x2D62U, 0x3CEBU, 0x0E70U, 0x1FF9U,
    0xF78FU, 0xE606U, 0xD49DU, 0xC514U, 0xB1ABU, 0xA022U, 0x92B9U, 0x8330U,
    0x7BC7U, 0x6A4EU, 0x58D5U, 0x495CU, 0x3DE3U, 0x2C6AU, 0x1EF1U, 0x0F78U
};

/** @brief 多项式0x10811的正序CRC表 */
const GM_UINT16 GM_CRC16_Table_0x10811_MSB[256U] =
{
    0x0000U, 0x0811U, 0x1022U, 0x1833U, 0x2044U, 0x2855U, 0x3066U, 0x3877U,
    0x4088U, 0x4899U, 0x50AAU, 0x58BBU, 0x60CCU, 0x68DDU, 0x70EEU, 0x78FFU,
    0x8110U, 0x8901U, 0x9132U, 0x9923U, 0xA154U, 0xA945U, 0xB176U, 0xB967U,
    0xC198U, 0xC989U, 0xD1BAU, 0xD9ABU, 0xE1DCU, 0xE9CDU, 0xF1FEU, 0xF9EFU,
    0x0A31U, 0x0220U, 0x1A13U, 0x1202U, 0x2A75U, 0x2264U, 0x3A57U, 0x3246U,
    0x4AB9U, 0x42A8U, 0x5A9BU, 0x528AU, 0x6AFDU, 0x62ECU, 0x7ADFU, 0x72CEU,
    0x8B21U, 0x8330U, 0x9B03U, 0x9312U, 0xAB65U, 0xA374U, 0xBB47U, 0xB356U,
    0xCBA9U, 0xC3B8U, 0xDB8BU, 0xD39AU, 0xEBEDU, 0xE3FCU, 0xFBCFU, 0xF3DEU,
    0x1462U, 0x1C73U, 0x0440U, 0x0C51U, 0x3426U, 0x3C37U, 0x2404U, 0x2C15U,
    0x54EAU, 0x5CFBU, 0x44C8U, 0x4CD9U, 0x74AEU, 0x7CBFU, 0x648CU, 0x6C9DU,
    0x9572U, 0x9D63U, 0x8550U, 0x8D41U, 0xB536U, 0xBD27U, 0xA514U, 0xAD05U,
    0xD5FAU, 0xDDEBU, 0xC5D8U, 0xCDC9U, 0xF5BEU, 0xFDAFU, 0xE59CU, 0xED8DU,
    0x1E53U, 0x1642U, 0x0E71U, 0x0660U, 0x3E17U, 0x3606U, 0x2E35U, 0x2624U,
    0x5EDBU, 0x56CAU, 0x4EF9U, 0x46E8U, 0x7E9FU, 0x768EU, 0x6EBDU, 0x66ACU,
    0x9F43U, 0x9752U, 0x8F61U, 0x8770U, 0xBF07U, 0xB716U, 0xAF25U, 0xA734U,
    0xDFCBU, 0xD7DAU, 0xCFE9U, 0xC7F8U, 0xFF8FU, 0xF79EU, 0xEFADU, 0xE7BCU,
    0x28C4U, 0x20D5U, 0x38E6U, 0x30F7U, 0x0880U, 0x0091U, 0x18A2U, 0x10B3U,
    0x684CU, 0x605DU, 0x786EU, 0x707FU, 0x4808U, 0x4019U, 0x582AU, 0x503BU,
    0xA9D4U, 0xA1C5U, 0xB9F6U, 0xB1E7U, 0x8990U, 0x8181U, 0x99B2U, 0x91A3U,
    0xE95CU, 0xE14DU, 0xF97EU, 0xF16FU, 0xC918U, 0xC109U, 0xD93AU, 0xD12BU,
    0x22F5U, 0x2AE4U, 0x32D7U, 0x3AC6U, 0x02B1U, 0x0AA0U, 0x1293U, 0x1A82U,
    0x627DU, 0x6A6CU, 0x725FU, 0x7A4EU, 0x4239U, 0x4A28U, 0x521BU, 0x5A0AU,
    0xA3E5U, 0xABF4U, 0xB3C7U, 0xBBD6U, 0x83A1U, 0x8BB0U, 0x9383U, 0x9B92U,
    0xE36DU, 0xEB7CU, 0xF34FU, 0xFB5EU, 0xC329U, 0xCB38U, 0xD30BU, 0xDB1AU,
    0x3CA6U, 0x34B7U, 0x2C84U, 0x2495U, 0x1CE2U, 0x14F3U, 0x0CC0U, 0x04D1U,
    0x7C2EU, 0x743FU, 0x6C0CU, 0x641DU, 0x5C6AU, 0x547BU, 0x4C48U, 0x4459U,
    0xBDB6U, 0xB5A7U, 0xAD94U, 0xA585U, 0x9DF2U, 0x95E3U, 0x8DD0U, 0x85C1U,
    0xFD3EU, 0xF52FU, 0xED1CU, 0xE50DU, 0xDD7AU, 0xD56BU, 0xCD58U, 0xC549U,
    0x3697U, 0x3E86U, 0x26B5U, 0x2EA4U, 0x16D3U, 0x1EC2U, 0x06F1U, 0x0EE0U,
    0x761FU, 0x7E0EU, 0x663DU, 0x6E2CU, 0x565BU, 0x5E4AU, 0x4679U, 0x4E68U,
    0xB787U, 0xBF96U, 0xA7A5U, 0xAFB4U, 0x97C3U, 0x9FD2U, 0x87E1U, 0x8FF0U,
    0xF70FU, 0xFF1EU, 0xE72DU, 0xEF3CU, 0xD74BU, 0xDF5AU, 0xC769U, 0xCF78U
};

/** @brief 多项式0x10811的逆序CRC表 */
const GM_UINT16 GM_CRC16_Table_0x10811_LSB[256] =
{
    0x0000U, 0x2314U, 0x4628U, 0x653CU, 0x8C50U, 0xAF44U, 0xCA78U, 0xE96CU,
    0x0881U, 0x2B95U, 0x4EA9U, 0x6DBDU, 0x84D1U, 0xA7C5U, 0xC2F9U, 0xE1EDU,
    0x1102U, 0x3216U, 0x572AU, 0x743EU, 0x9D52U, 0xBE46U, 0xDB7AU, 0xF86EU,
    0x1983U, 0x3A97U, 0x5FABU, 0x7CBFU, 0x95D3U, 0xB6C7U, 0xD3FBU, 0xF0EFU,
    0x2204U, 0x0110U, 0x642CU, 0x4738U, 0xAE54U, 0x8D40U, 0xE87CU, 0xCB68U,
    0x2A85U, 0x0991U, 0x6CADU, 0x4FB9U, 0xA6D5U, 0x85C1U, 0xE0FDU, 0xC3E9U,
    0x3306U, 0x1012U, 0x752EU, 0x563AU, 0xBF56U, 0x9C42U, 0xF97EU, 0xDA6AU,
    0x3B87U, 0x1893U, 0x7DAFU, 0x5EBBU, 0xB7D7U, 0x94C3U, 0xF1FFU, 0xD2EBU,
    0x4408U, 0x671CU, 0x0220U, 0x2134U, 0xC858U, 0xEB4CU, 0x8E70U, 0xAD64U,
    0x4C89U, 0x6F9DU, 0x0AA1U, 0x29B5U, 0xC0D9U, 0xE3CDU, 0x86F1U, 0xA5E5U,
    0x550AU, 0x761EU, 0x1322U, 0x3036U, 0xD95AU, 0xFA4EU, 0x9F72U, 0xBC66U,
    0x5D8BU, 0x7E9FU, 0x1BA3U, 0x38B7U, 0xD1DBU, 0xF2CFU, 0x97F3U, 0xB4E7U,
    0x660CU, 0x4518U, 0x2024U, 0x0330U, 0xEA5CU, 0xC948U, 0xAC74U, 0x8F60U,
    0x6E8DU, 0x4D99U, 0x28A5U, 0x0BB1U, 0xE2DDU, 0xC1C9U, 0xA4F5U, 0x87E1U,
    0x770EU, 0x541AU, 0x3126U, 0x1232U, 0xFB5EU, 0xD84AU, 0xBD76U, 0x9E62U,
    0x7F8FU, 0x5C9BU, 0x39A7U, 0x1AB3U, 0xF3DFU, 0xD0CBU, 0xB5F7U, 0x96E3U,
    0x8810U, 0xAB04U, 0xCE38U, 0xED2CU, 0x0440U, 0x2754U, 0x4268U, 0x617CU,
    0x8091U, 0xA385U, 0xC6B9U, 0xE5ADU, 0x0CC1U, 0x2FD5U, 0x4AE9U, 0x69FDU,
    0x9912U, 0xBA06U, 0xDF3AU, 0xFC2EU, 0x1542U, 0x3656U, 0x536AU, 0x707EU,
    0x9193U, 0xB287U, 0xD7BBU, 0xF4AFU, 0x1DC3U, 0x3ED7U, 0x5BEBU, 0x78FFU,
    0xAA14U, 0x8900U, 0xEC3CU, 0xCF28U, 0x2644U, 0x0550U, 0x606CU, 0x4378U,
    0xA295U, 0x8181U, 0xE4BDU, 0xC7A9U, 0x2EC5U, 0x0DD1U, 0x68EDU, 0x4BF9U,
    0xBB16U, 0x9802U, 0xFD3EU, 0xDE2AU, 0x3746U, 0x1452U, 0x716EU, 0x527AU,
    0xB397U, 0x9083U, 0xF5BFU, 0xD6ABU, 0x3FC7U, 0x1CD3U, 0x79EFU, 0x5AFBU,
    0xCC18U, 0xEF0CU, 0x8A30U, 0xA924U, 0x4048U, 0x635CU, 0x0660U, 0x2574U,
    0xC499U, 0xE78DU, 0x82B1U, 0xA1A5U, 0x48C9U, 0x6BDDU, 0x0EE1U, 0x2DF5U,
    0xDD1AU, 0xFE0EU, 0x9B32U, 0xB826U, 0x514AU, 0x725EU, 0x1762U, 0x3476U,
    0xD59BU, 0xF68FU, 0x93B3U, 0xB0A7U, 0x59CBU, 0x7ADFU, 0x1FE3U, 0x3CF7U,
    0xEE1CU, 0xCD08U, 0xA834U, 0x8B20U, 0x624CU, 0x4158U, 0x2464U, 0x0770U,
    0xE69DU, 0xC589U, 0xA0B5U, 0x83A1U, 0x6ACDU, 0x49D9U, 0x2CE5U, 0x0FF1U,
    0xFF1EU, 0xDC0AU, 0xB936U, 0x9A22U, 0x734EU, 0x505AU, 0x3566U, 0x1672U,
    0xF79FU, 0xD48BU, 0xB1B7U, 0x92A3U, 0x7BCFU, 0x58DBU, 0x3DE7U, 0x1EF3U
};

/*isHighFirst=1,多项式0x1021，正序表
isHighFirst=0，多项式0x1021，逆序表，传入多项式0x1021*/
GM_BOOL GM_CRC_Build_CRC16_Table(GM_UINT32 polynomial, GM_UINT16 pCRCTable[], GM_BOOL isHighFirst)
{
    int j         = 0U;
    GM_UINT32 crc = 0U;
    int i         = 0U;
	GM_UINT32 POLY=0U;

    if (NULL == pCRCTable)
    {
        return GM_FALSE;
    }

    if (GM_FALSE == isHighFirst)
    {
		POLY = GM_CRC_Reflect(polynomial,16U);
		for (i = 0U; i < 256U; ++i)
		{
			crc = (GM_UINT32)i & 0x000000ffU;

			for (j = 0U; j < 8U; ++j)
			{
				if ((GM_UINT32)0U != (crc & (GM_UINT32)0x01U))
				{
					crc = (crc >> 1U) ^ POLY;
				}
				else
				{
					crc >>= 1U;
				}
			}

			pCRCTable [i] = (GM_UINT16)crc;

		}
    }
    else
    {
		for (i = 0U; i < 256U; ++i)
		{
			crc = (GM_UINT32)(i << 8U);

			for (j = 0U; j < 8U; ++j)
			{
				if ((GM_UINT32)0U != (crc & (GM_UINT32)0x00008000U))
				{
					crc = (crc << 1U) ^ polynomial;
				}
				else
				{
					crc <<= 1U;
				}
			}

			pCRCTable[i] = (GM_UINT16)crc;
		}

    }

    return GM_TRUE;
}

